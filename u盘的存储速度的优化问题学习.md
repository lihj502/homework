# **u盘的存储速度的优化问题**  

   * [<strong>u盘的存储速度的优化问题</strong>](#u盘的存储速度的优化问题)
      * [一、背景](#一背景)
      * [二、优化方法](#二优化方法)
      * [三、优化原理](#三优化原理)
      * [四、前文相应注释](#四前文相应注释)
      * [参考资料](#参考资料)

## 一、背景

在日常u盘的使用情景中，总是会出现一些课程（例如自动化的计算机基础课）需要使用很多软件来辅助完成教学任务，在需要下载使用这些软件的时候，有时会出现宿舍WiFi网速过慢，无法在预留的时间里完成软件的下载的问题，这时我的选择通常是去同学那用u盘直接拷贝课程所需的软件安装包，但是就会出现一个问题，u盘的存储速度过慢（有时拷贝文件的速度甚至达到字节每秒），因此我开始在网络上查找优化u盘存储速度的方法。



## 二、优化方法

1. 在“此电脑”<img src="https://gitee.com/gritandsea/picture/raw/master/img/.png" style="zoom:50%;" />中找到u盘，右击，在菜单中选择属性。

2. 在属性中的顶部选项中选择硬件选项，找到对应的磁盘驱动器OnlyDisk

   <img src="https://gitee.com/gritandsea/picture/raw/master/img/20201225212640.png" height = "350px"/>

3. 打开它的属性，使用管理员权限改变设置

   <img src="https://gitee.com/gritandsea/picture/raw/master/img/20201225213303.png" height = "350px"/>

4. 进入策略选项，一般u盘的默认选项是快速删除，将其改为更好的性能，即可完成u盘的更改，之后u盘的存储速度将会变快。

   <img src="https://gitee.com/gritandsea/picture/raw/master/img/20201225213412.png" height = "350px"/>



## 三、优化原理

正如策略里面对于更好的性能的描述一样，此种优化技术实际上是**启用了windows中的写入缓存功能**，这是一种读写技术，可以在很多应用场景下提高硬盘的读写速度，节省时间。

U盘默认存储的速度通常比较慢，但是如果我启用了windows中的写入缓存功能的话，那么U盘的存储速度将会变得非常快。~~因为当你将文件存入U盘的时候，系统实际上会先将数据写入缓存，而并没有实际将数据直接存入u盘，然后会发送一个“数据已写入”的信号给系统，这样在提示的进度窗口中的进度条完成加载的速度就会很快，看起来仿佛立即就写好了。但是事实上在进度条显示完成，窗口关闭以后，系统在后台才会真正一点一点的将存入缓存的数据存储进u盘。~~

**上述删除内容的疑点:**  如果是这样那么就相当于其实u盘拷入数据的速度并没有真正的增加，和事实（确实存储速度变快，因为进度条完成以后就可以进行弹出操作，而且数据可以被完整的拷入）不符。

**真正原因:**  

**首先先来谈谈这里说到的缓存是什么，**这里提到的缓存是一个相对逻辑的概念，暂时不要去深究它物理上的概念。

如果要去理解什么是缓存那么可以说，这个是相对的，“相对于某个其他存储介质来说更快，空间有限的存储介质”，它出现的目的是将一大堆数据里最可能被多次或者长期使用的一小部分放到一个更容易快速获取的地方

那么现在话先回来，**现在先来解释写入缓存功能的真正内部机制**

其实翻译为写缓存其实这里翻译的并不严谨，准确一点说应该是说写缓冲区（这里先要澄清，这个写缓存和写缓冲区并不相同），**正常的u盘默认存储策略可以看作是考试涂卡时一次看一道题涂一个题，再类比到存储文件，就是读一个文件写一个文件，因此速度会非常的慢**，这也能够解释为什么同样大小的文件夹，如果内部只有一个大文件读的就会比较快，如果都是小文件读的就会非常慢了。**现在你刚刚看了一个题的答案如果突然有人在你耳边大吼一声，你刚刚看到的选择题答案很大程度上不会被吓忘（这就是突然断电）**；那么如果是使用另一个优化策略写入缓冲区呢？**就相当于你涂卡的时候是一次看五个或者十个再或者全记下来再涂，也就是把很多的文件全部读入缓冲区，然后那个人又大吼一声，可能大部分读入的东西都被吓忘了**，这也就是为何说启动这个策略后不能直接拔下u盘，需要先安全弹出了。**这个策略不仅仅有着存储速度快的优点，同时可以保护硬盘延长硬盘的使用寿命**，因为这个策略是等预先设定的缓存被充满以后才开始连续的写入磁盘，因此可以大幅度的减少写入的次数，即减少磁头移动的次数，这就相当于超市买菜等把所有要买的菜都放进购物车再去收银台进行结算的原理相同，否则拿一个就跑去收银台结算一次，估计会好累好累

**那么再来简单理解解释一下什么是读缓存**，事实上就是把常用的数据（使用频率高的数据，也就是热数据），单独放到能快速获取的地方进行储存，就比如把经常穿的衣服挂在外面的衣架上而不是挂在衣柜里一样

**注意：这个技术在带来速度的提升之后也有着它的使用缺点**

- 不要在向u盘中拷贝资料的时候突然断电，否则你目前正在拷贝的资料就很有可能会损坏或者缺失。

- 一旦更改策略为更好的性能以后，在使用U盘的时候就需要每次拔出U盘之前要通过选择“安全弹出U盘”的选项再拔出U盘，否则就容易发生部分数据丢失或者受损的情况。



## 四、前文相应注释

1. **快速删除:** 选取这个选项，能提高u盘的工作性能，可以有效地保护u盘，并达到延长u盘使用寿命的目的。这样的选项能够减少数据向U盘中的写入次数，减少磁头移动的次数，并且这样每一次都是真正的写入u盘内，可以不用u盘安全弹出，直接拔下u盘。

2. **管理员权限:** 管理员身份运行的目的是引入一个安全机制，为了保护系统及程序安全，阻止未经授权的更改，有效遏制恶意程序的破坏。

   由于原来的专业是自动化类，因此在计算机基础课上会接触很多软件，大多数都是专业的软件都需要对软件进行破解，而此时大多都需要使用到管理员权限,因此联想到这些软件使用注册机破解都需要先用管理员权限运行，因此就可以将管理员身份运行理解为用系统管理最高权限运行，这样可以在程序或者命令运行过程中更改系统设置或者是注册表，如果是普通用户通常只有读的权限，没有改的权限，也就无法完成更改操作，那就无法使用注册机对软件进行破解了。

3. **缓存:** 首先需要明确的是，U盘没有缓存,一个U盘上面最主要的两个芯片一个是主控芯片另一个一个是闪存芯片。因此其实一开始数据写入的是计算机自己的缓存，这也就可以解释为什么电脑在存储过程中一旦断电，数据就会有丢失或者受损，因为计算机的缓存在断电后就会清空。

   **PS:** 缓存位于CPU与内存之间的临时存储器，它的容量比内存小但交换速度快，

4. **数据丢失:** 其实u盘并没有什么数据丢失，其实是操作系统并没有成功的将数据传输过来。  

  

---



## 参考资料

- [一文读懂热插拔](https://www.ithome.com/0/467/290.htm)

- [热插拔](https://baike.baidu.com/item/%E7%83%AD%E6%8F%92%E6%8B%94/203637?fr=aladdin)

- [写入缓存到底是个什么东西，是好东西还是坏东西，能起到什么作用呢。](https://zhidao.baidu.com/question/128820962.html)

- [什么是Windows写入缓存功能,如何关闭U盘写入缓存功能?](https://www.beihaiting.com/a/XTJC/XTJQ/2014/0424/4433.html)

- [U盘要不要打开写入缓存？ ](http://bbs.pceva.com.cn/thread-94752-1-1.html)

- [u盘写入缓存策略](http://www.udaxia.com/wtjd/3342.html)

- [C语言缓存区详解](https://blog.csdn.net/zhao2chen3/article/details/81707805)

- [缓存](https://baike.baidu.com/item/%E7%BC%93%E5%AD%98/100710?fr=aladdin)

- [缓冲区(buffer)与缓存(cache)](https://www.cnblogs.com/mlgjb/p/7991903.html)

- [硬盘写入缓存功能是什么？](http://ask.zol.com.cn/q/1913193.html)

- [缓存是什么](https://zhidao.baidu.com/question/71383784.html)

- [关于“写入缓存策略”设置](https://answers.microsoft.com/zh-hans/windows/forum/windows_7-performance/%e5%85%b3%e4%ba%8e%e5%86%99%e5%85%a5%e7%bc%93/ed3ce6f3-7df2-488a-9f30-e3cdf01d19f7?messageId=15de67d0-1faa-4342-a706-fccac57a7482)

